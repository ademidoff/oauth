    <script>
      // Tell the main plugin code that the UI is ready
      parent.postMessage({ pluginMessage: { type: 'ui-ready-for-user-info' } }, '*');
      
      // Listen for messages from the plugin
      window.onmessage = async (event) => {
        const message = event.data.pluginMessage;
        
        if (message.type === 'get-user-info') {
          try {
            const accessToken = message.accessToken;
            const response = await fetch("${SITE_URL}/auth/user", {
              headers: {
                'Authorization': 'Bearer ' + accessToken
              },
              credentials: 'include'
            });
            
            if (response.ok) {
              const user = await response.json();
              parent.postMessage({ 
                pluginMessage: { 
                  type: 'user-info-result', 
                  user 
                } 
              }, '*');
            } else {
              if (response.status === 401) {
                parent.postMessage({ 
                  pluginMessage: { 
                    type: 'auth-expired'
                  } 
                }, '*');
              } else {
                throw new Error("Failed to fetch user data");
              }
            }
          } catch (error) {
            console.error("User info error:", error);
            parent.postMessage({ 
              pluginMessage: { 
                type: 'user-info-error', 
                error: error.message 
              } 
            }, '*');
          }
        }
      };
    </script>
